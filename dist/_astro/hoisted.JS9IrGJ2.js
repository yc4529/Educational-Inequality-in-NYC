import{m as d}from"./maplibre-gl.CwxBg0Yq.js";import"./hoisted.RlhmG3H2.js";class f extends HTMLElement{constructor(){super();const i=new d.Map({container:this.dataset.container||"maplibre-map",interactive:this.dataset.interactive?JSON.parse(this.dataset.interactive):!1,center:[this.dataset.longitude?parseFloat(this.dataset.longitude):0,this.dataset.latitude?parseFloat(this.dataset.latitude):0],zoom:this.dataset.zoom?parseFloat(this.dataset.zoom):void 0,style:this.dataset.mapstyle});i.on("load",()=>{const p=this.dataset.layers?JSON.parse(this.dataset.layers):void 0;p&&(p.forEach(t=>{if(t.toggle){const e=document.createElement("a"),o=document.getElementById("menu");e.textContent=t.label??t.id,t.visible===!0&&(e.className="active"),e.onclick=()=>{i.getLayoutProperty(t.id,"visibility")==="visible"?(i.setLayoutProperty(t.id,"visibility","none"),e.className=""):(i.setLayoutProperty(t.id,"visibility","visible"),e.className="active")},o&&o.appendChild(e)}}),p.forEach(t=>{if(t["data-type"]==="geojson"&&(fetch(t.url).then(e=>e.json()).then(e=>{e.features.forEach(o=>{o.geometry||(o.geometry={type:"Point",coordinates:[Number(o.properties.longitude),Number(o.properties.latitude)]})}),i.getSource(t.id)||i.addSource(t.id,{type:"geojson",data:e}),i.getLayer(t.id)||i.addLayer({id:t.id,type:t["layer-type"],source:t.id,paint:t.paint||{},layout:{visibility:t.visible?"visible":"none"}})}),t.mouseEvent)){const e=new d.Popup({offset:15});t.mouseEvent.forEach(o=>{i.on(o.type,t.id,r=>{const l=o.content.map(n=>{const a=Object.keys(n)[0];console.log(n[a]);const c=Array.isArray(n[a])?n[a].map(s=>{if("property"in s)return r.features&&r.features[0]&&r.features[0].properties[s.property]||s.else;if("str"in s)return s.str;if(a==="a"&&"href"in s&&"text"in s)return`<a href="${s.href}" target="_blank">${s.text}</a>`;if(a==="img"&&"src"in s){const u=s.alt||"";return`<img src="${s.src}" alt="${u}" />`}else return""}).join(" "):n[a];return`<${a}>${c}</${a}>`}).join(" ");e.setLngLat(r.lngLat).setHTML(l).addTo(i),o.type==="mousemove"&&i.on("mouseleave",t.id,()=>{e.remove()})})})}}))})}}window.customElements.define("maplibre-fullpage-map",f);
